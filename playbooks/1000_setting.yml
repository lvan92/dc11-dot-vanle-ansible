---
  - hosts: ap-s1
    become: yes
    become_method: sudo
    vars_files:
      - host_vars/ap-s1.yml
    vars:
      ansible_ssh_private_key_file: "{{ private_key }}"
    tasks:
      - name: 1. Update OS
        command: apt update

      - name: 2. Add the intermediate certificate to certificate bundle
        command: update-ca-certificates

      - name: 3. Install ca cerfiticates
        apt: name= ca-cerfiticates state= present force_apt_get= yes

      - name: 4. Install software properties common
        apt:
          name: software-properties-common
          state: present
          force_apt_get: yes

      - name: 6. Install aptitude using apt
        apt:
          name: aptitude
          state: present
          force_apt_get: yes

      - name: 7. Install common required system packages
        apt:
          name: "{{ common_required_packages }}"
          state: present
          force_apt_get: yes
